## 背景
这个控制器是为了解决[pod无限创建]()的问题而存在的。pod的无限创建问题在k8s的各个版本中都可以复现，而且复现的方式五花八门，难以通过规范和版本升级这两种方法解决。

而bug一旦复现，会在很短的时间内破坏集群的可用性（大约3-4小时，视master的配置而定）。它会在etcd和apiserver中填充大量的对象，导致master节点内存飙升，影响正常服务的使用。

## 处理
在社区中有关于限速创建对象和分批创建对象的讨论，但是由于这些方式都会让正常使用的用户怀疑k8s功能出错，所以均无法通过。而删除pod对象本身也属于不符合直觉的处理方式，故短期内可能很难得到正式的处理。

在这里就使用这个控制器去临时的控制Failed pod的数量，一旦一个workload中的Failed pod超出了预期的数量，控制器会删除该workload。以确保在极端环境下集群的可用性。

## 用法
通过在workload的label中设置`holooooo.io/MaxFailedPod`来指定允许的最大失败pod数量。设置为0代表不限制。为空则使用默认配置。

默认配置会去检查这种对象预期的pod数量(如deployment中的replica字段)。如果预期pod数量小于等于10，则允许50个失败pod；否则允许5倍预期数量的失败pod。